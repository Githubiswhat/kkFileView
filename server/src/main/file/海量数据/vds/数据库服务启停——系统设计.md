## 1.功能简述

1. 提供可视化数据库服务启停功能，用户可以通过可视化窗口来启动和关闭数据库服务；
2. 对于已经启动的数据库服务，用户可以对该服务进行关闭操作；
3. 对于已经关闭的数据库服务，用户可以对该服务进行启动操作；

## 2.系统部件

### 2.1关键数据结构说明

| 字典   |               说明                | 必填 | 允许修改 |
| :----- | :-------------------------------: | ---: | -------- |
| 主机   |        数据库服务所在主机         |   是 | 否       |
| 端口   |    数据库服务所在主机的SSH端口    |   是 | 是       |
| 用户名 | 数据库服务所在主机的SSH登录用户名 |   是 | 是       |
| 密码   |  数据库服务所在主机的SSH登录密码  |   是 | 是       |

## 3执行方案

- 启动服务
  - 根据用户填写的SSH服务器信息，后台向服务器发起SSH连接请求，连接建立之后，发送数据库服务启动命令``` vb_ctl restart``` ，读取服务器返回的执行命令结果
- 关闭服务
  - 根据用户填写的SSH服务器信息，后台向服务器发起SSH连接请求，连接建立之后，发送数据库服务启动命令``` vb_ctl stop``` ，读取服务器返回的执行命令结果

### 3.1流程/交互设计

![数据库服务启停.drawio](C:\Users\windows\Desktop\数据库服务启停.drawio.png)

### 3.2关键Shell命令

```
vb_ctl restart
vb_ctl stop
```

### 3.3 补充说明

1. 在网络波动和对方主机应答缓慢的情况下，有可能存在SSH连接时间过长的问题，目前设置的超时时间为30秒
2. 建立连接之后，发送命令到目标服务器，如果命令执行成功则关闭窗口，如果命令执行失败则提示错误信息，由于错误的原因有多种，目前只处理了一些常见的错误原因
   - 数据库服务已经关闭的情况下，发送关闭数据库服务的命令
   - SSH连接认证失败

